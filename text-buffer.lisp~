(in-package #:qix)

(defun string-insert (string text &optional (pos (1- (length string))))
  (concatenate 'string
	       (subseq string 0 pos)
	       text
	       (subseq string pos (1- (length string)))))

(defun string-remove (string pos &optional (len 1))
  (let ((str-len (length string)))
    (cond ((>= pos str-len)  string)
	  ((>= (+ pos len) str-len) (subseq string 0 pos))
	  ((zerop pos) (subseq string len))
	  (t (concatenate 'string 
			  (subseq string 0 pos)
			  (subseq string (+ pos len)))))))
		    


